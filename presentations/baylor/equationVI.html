<!DOCTYPE html>
<meta charset="utf-8">
<head>
<style>
    @import url('slide.css');

    body {
      font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
      position: relative;
      width: 960px;
    }

    .axis path,
    .axis line {
        fill: none;
        stroke: #000;
        shape-rendering: crispEdges;
        font: 20px;
    }

    
    text {
        font: 20px sans-serif;
    }
    
    .x.axis path {
        display: none;
    }
    
    .redLine {
        fill: none;
        stroke: red;
        stroke-width: 1.5px;
    }
    
    .greenLine {
        fill: none;
        stroke: green;
        stroke-width: 1.5px;
    }
    .blueLine {
        fill: none;
        stroke: blue;
        stroke-width: 1.5px;
    }
    
    .inputholder {
        font-size: 24px;
        position: absolute;
        top: 230px;
        right: -150px;
    }

    }
    #info {
        font-size: 24px;}
</style>

<script type="text/javascript"
  src="https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript" src="http://d3js.org/d3.v3.js"></script>
</head>
<script type="text/javascript"
  src="https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

  <body>
      <h1 class="slideTitle"> equation 6: spectral sensitivities </h1>
    <div class="JAX">
	  \[\begin{aligned}
	  log(S) &amp; = \sum_{n=0}^{6} a_{n} [log(\frac{1}{\lambda} \frac{\lambda_{m}}{\lambda_{r}})]^{n},
	  \end{aligned} \]
	</div>
      <script>
          
          var margin = {top: 20, right: 50, bottom: 80, left: 100},
          width = 725 - margin.left - margin.right,
          height = 425 - margin.top - margin.bottom;

          
          var x = d3.scale.linear()
          .range([width + 30, 30]);
          
          var y = d3.scale.linear()
          .range([height - 10, -10]);
 
          var x2 = d3.scale.linear()
          .range([width + 30, 30]);
          
          var y2 = d3.scale.linear()
          .range([height - 10, -10]);
          
          var x3 = d3.scale.linear()
          .range([width + 30, 30]); 
          
          var y3 = d3.scale.linear()
          .range([height - 10, -10]);
          
          
          var xAxis = d3.svg.axis()
          .scale(x)
          .ticks(5)
          .orient("bottom");
          
          var yAxis = d3.svg.axis()
          .scale(y2)
          .ticks(5)
          .orient("left");
         
          
          function genCurve(lam_M, lam_R) {
              
          //constants:
          var a = [-5.2734, -87.403, 1228.4, -3346.3, -5070.3, 30881.0, -31607.0];
          var xVal = d3.range(0.38,0.75,0.0001);
              
          // nested function to find y values:
          var yVal = function(lambda, lam_M, lam_R) {
                var S = 0;
                for (var n=0; n < 7; n++) {
                    S += (a[n] * Math.pow( log10((1.0/lambda) * (lam_M/lam_R)),n) );
                    };
                return S;
                };
              
          // now use constants, input values and y value function to generate a curve:
          var data = [];
          for (i=0;  i < xVal.length; i++) {
              data.push({"x": 1/xVal[i], "y": yVal(xVal[i], lam_M, lam_R)});
          };
              return data;
          };
          
          redData = genCurve( 561.0, 561.0);
          greenData = genCurve( 530.0, 561.0);
          blueData = genCurve( 430.0, 561.0);
         
          var line = d3.svg.line()
          .x(function(d) { return x(d.x); })
          .y(function(d) { return y(d.y); });

          var line2 = d3.svg.line()
          .x(function(d) { return x(d.x); })
          .y(function(d) { return y(d.y); });
          
          var line3 = d3.svg.line()
          .x(function(d) { return x(d.x); })
          .y(function(d) { return y(d.y); });
          

          var svg = d3.select("body").append("svg")
          .attr("width", width + margin.left + margin.right)
          .attr("height", height + margin.top + margin.bottom)
          .append("g")
          .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
                 
          x.domain(d3.extent(redData, function(d) { return d.x; }));
          y.domain(d3.extent(redData, function(d) { return d.y; }));

          x2.domain(d3.extent(greenData, function(d) { return d.x; }));
          y2.domain(d3.extent(greenData, function(d) { return d.y; }));
          
          x3.domain(d3.extent(blueData, function(d) { return d.x; }));
          y3.domain(d3.extent(blueData, function(d) { return d.y; }));
          
          svg.append("g")
                 .attr("class", "x axis")
                 .attr("transform", "translate(0," + height + ")")
                 .call(xAxis)
                 .append("text")
                 .attr("x", (width - 30) / 2)
                 .attr("y", 65)
                 .text("wavenumber (um^-1)");
                 
          svg.append("g")
                 .attr("class", "y axis")
                 .call(yAxis)
                 .append("text")
                 .attr("transform", "rotate(-90)")
                 .attr("y", 6)
                 .attr("dy", ".71em")
                 .style("text-anchor", "end")
                 .text("log S");


          svg.append("path")
                 .datum(redData)
                 .attr("class", "redLine")
                 .attr("d", line);

          svg.append("path")
                  .datum(greenData)
                  .attr("class", "greenLine")
                  .attr("d", line2);
          
          svg.append("path")
                  .datum(blueData)
                  .attr("class", "blueLine")
                  .attr("d", line3);

          d3.select("body")
                .append("div")
                 .attr("class","inputholder")
                .append("input")
                 .attr("id", "redInput")
                 .attr("type", "range")
                 .attr("min",430)
                 .attr("max", 620)
                 .attr("step", 1)
                 .attr("value", 561);
 
          d3.select(".inputholder").append("span")
              .attr("id", "red_text")
              .style("color", "red")
              .text("lambda_r: ")
              .append("span")
              .attr("id", "red_val")
              .style("color", "red")
              .text(561 + " nm");
          d3.select(".inputholder").append("br");
          
          d3.select(".inputholder")
                  .append("input")
                  .attr("id", "greenInput")
                  .attr("type", "range")
                  .attr("min",430)
                  .attr("max", 620)
                  .attr("step", 1)
                  .attr("value", 530);
 
          d3.select(".inputholder").append("span")
              .attr("id", "green_text")
              .style("color", "green")
              .text("lambda_r: ")
              .append("span")
              .attr("id", "green_val")
              .style("color", "green")
              .text(561 + " nm");
          d3.select(".inputholder").append("br");
          
          
          d3.select(".inputholder")
                  .append("input")
                  .attr("id", "blueInput")
                  .attr("type", "range")
                  .attr("min",430)
                  .attr("max", 620)
                  .attr("step", 1)
                  .attr("value", 430);
          
          d3.select(".inputholder").append("span")
              .attr("id", "blue_text")
              .style("color", "blue")
              .text("lambda_r: ")
              .append("span")
              .attr("id", "blue_val")
              .style("color", "blue")
              .text(561 + " nm");
          d3.select(".inputholder").append("br");

          d3.select("#redInput").on("change", changeRed);
          d3.select("#greenInput").on("change", changeGreen);
          d3.select("#blueInput").on("change", changeBlue);
          
          function changeRed() {
              d3.select(".redLine").remove();
              d3.select("#red_val").remove();
                  
              d3.select("#red_text").append("span")
               .attr("id", "red_val")
               .style("color", "red")
               .text(this.value + " nm");
                  
              redData = genCurve( 561.0, this.value);
              svg.append("path")
              .datum(redData)
              .attr("class", "redLine")
              .attr("d", line);
          };


          function changeGreen() {
              d3.select(".greenLine").remove();
              d3.select("#green_val").remove();
                  
              d3.select("#green_text").append("span")
               .attr("id", "green_val")
               .style("color", "green")
               .text(this.value + " nm");
                 
              greenData = genCurve( 530.0, this.value);
              svg.append("path")
                  .datum(greenData)
                  .attr("class", "greenLine")
                  .attr("d", line2);
          };
          
          function changeBlue() {
              d3.select(".blueLine").remove();
              d3.select("#blue_val").remove();
                  
              d3.select("#blue_text").append("span")
               .attr("id", "blue_val")
               .style("color", "blue")
               .text(this.value + " nm");
              
              blueData = genCurve( 430.0, this.value);
              svg.append("path")
                  .datum(blueData)
                  .attr("class", "blueLine")
                  .attr("d", line3);
          };
          
          function log10(val) {
              return Math.log(val) / Math.LN10;
          };
          </script>

  </body>
</html>